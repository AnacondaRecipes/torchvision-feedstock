From eaed650ddf26a0e4ef6af9f3e42237fd7a8dafa2 Mon Sep 17 00:00:00 2001
From: Jamie Robertson <jamierobertsongames@gmail.com>
Date: Mon, 23 Feb 2026 10:57:26 +0000
Subject: [PATCH] numpy 2 compatibility in test
---
 torchvision/datasets/_optical_flow.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/torchvision/datasets/_optical_flow.py b/torchvision/datasets/_optical_flow.py
index 52884dbc18..778e58a99a 100644
--- a/torchvision/datasets/_optical_flow.py
+++ b/torchvision/datasets/_optical_flow.py
@@ -503,8 +503,8 @@ def _read_flo(file_name: str) -> np.ndarray:
         if magic != b"PIEH":
             raise ValueError("Magic number incorrect. Invalid .flo file")
 
-        w = int(np.fromfile(f, "<i4", count=1))
-        h = int(np.fromfile(f, "<i4", count=1))
+        w = int(np.fromfile(f, "<i4", count=1)[0])
+        h = int(np.fromfile(f, "<i4", count=1)[0])
         data = np.fromfile(f, "<f4", count=2 * w * h)
         return data.reshape(h, w, 2).transpose(2, 0, 1)
 
-- 
2.50.1 (Apple Git-155)

